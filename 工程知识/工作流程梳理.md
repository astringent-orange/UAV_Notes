
# 仿真环境
例如神经网络计算出一个期望速度，然后此时需要agent的ros节点以话题发布一个期望速度。

而px4无法直接接受ros话题消息，只懂mavlink协议。mavros是一个后台的ros节点，将ros速度类型转换为mavlink协议中的消息类型，然后将这个数据包以udp发送给px4

px4 sitl（software in the loop）
此时是一个电脑上的程序，接受到指定的速度设定，输出四个电机的推力值

由于此时没有真实的电机，所以px4要把信号发送给gazebo
**PX4 -> Gazebo (mavlink_sitl_gazebo 插件)**
- PX4 通过 UDP (通常是本机端口 14560) 将电机转速指令发送出去。
- **Gazebo 插件**：在 Gazebo 中，你导入的无人机模型（.sdf 文件）里包含了一个名为 mavlink_sitl_gazebo 的插件。这个插件负责监听 PX4 发来的电机指令。

#### Gazebo 物理计算
- **施力**：Gazebo 接收到“电机转速”后，根据物理引擎（ODE 或 Bullet），计算螺旋桨产生的升力和阻力。
- **刚体动力学**：物理引擎计算这些力如何作用在无人机刚体上，结合重力、空气阻力等，计算出无人机下一时刻的**位姿 (Pose)** 和 **速度 (Velocity)**。

    - 结果：无人机在仿真画面里向前移动了。


gazebo计算出一些传感器原始数据，然后通过mavlink发送给px4。mavros再接受px4发送的mavlink消息，翻译为ros消息，给回agent


关键接口
ros到飞控px4（mavlink），px4与仿真环境。部分情况下会更换其中一些部件，因为整个流程的通信消耗太高了